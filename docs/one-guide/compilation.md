# hello.c 的编译

## 为什么要编译

`hello.c`是我们编辑的，我们很容易看懂，但是计算机看不懂，所以我们需要一套能将文本文件翻译成计算机可执行的二进制文件的系统，就是编译系统。  
![编译系统](http://ww1.sinaimg.cn/large/e1b0b6d4ly1g2fa2d608mj20s506m0t2.jpg)

- **预处理阶段**。预处理器（cpp）根据字符以 # 开头的命令。修改原始的 C 程序。比如`hello.c`中的第一行：

```c
#include <stdio.h>
```

命令告诉预处理器读取系统头文件`studo.h`的内容，并把它直接插入到程序文本中。结果就得到了另一个 C 程序。  

- **编译阶段**。编译器（ccl）将文本文件 `hello.i` 翻译成文件文件 `hello.s`，它包含一个汇编语言程序。该程序包含函数 `main` 的定义，如下：  

```c
main:
    subp    $8, %rsp
    movl    $.LOC, %edi
    call    puts
    movl    $0, %eax
    addq    $8, %rsp
ret
```

- **汇编阶段**。汇编器（as）将 `hello.js` 翻译成机器语言指令 `hello.o`。

- **链接阶段**。我们调用了 `printf` 函数，它是每个 C 编译器都提供的标准 C  库中的一个函数。它位于一个名为 `printf.o` 的单独的预编译好了的目标文件中。链接器负责将他们合并为可执行文件。

## 了解编译的好处

- 优化程序性能。如，一个函数调用的开销有多大。

- 理解链接时出现的错误。

- 避免缓冲区溢出带来的安全漏洞。